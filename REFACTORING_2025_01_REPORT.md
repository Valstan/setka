# üîß SETKA - –û—Ç—á—ë—Ç –æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–µ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –æ—à–∏–±–æ–∫

**–î–∞—Ç–∞:** 2025-01-XX  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û  
**–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã:** ~1 —á–∞—Å

---

## üìä –†–ï–ó–Æ–ú–ï

–ü—Ä–æ–≤–µ–¥—ë–Ω –ø–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–µ–∫—Ç–∞ SETKA, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏, –ø—Ä–æ–≤–µ–¥—ë–Ω —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∫–æ–¥–∞ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

---

## ‚úÖ –í–´–ü–û–õ–ù–ï–ù–ù–´–ï –ó–ê–î–ê–ß–ò

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ bare `except:` –±–ª–æ–∫–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `except:` –±–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è —Ç–∏–ø–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è - –ø–ª–æ—Ö–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞, —Å–∫—Ä—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤:**
- `modules/celery_task_monitor.py` (—Å—Ç—Ä–æ–∫–∞ 264)
- `web/api/token_management.py` (—Å—Ç—Ä–æ–∫–∏ 255, 262, 269)
- `modules/notifications/vk_messages_checker.py` (—Å—Ç—Ä–æ–∫–∞ 76)

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
```python
# –ë—ã–ª–æ:
except:
    formatted_time = date_done

# –°—Ç–∞–ª–æ:
except (ValueError, AttributeError, TypeError) as e:
    logger.warning(f"Failed to parse date_done '{date_done}': {e}")
    formatted_time = date_done
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –¢–µ–ø–µ—Ä—å –≤—Å–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —è–≤–Ω–æ, –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è.

---

### 2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

**–ü—Ä–æ–±–ª–µ–º–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `NullPool` –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –¥–ª—è production - –∫–∞–∂–¥–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è –∑–∞–Ω–æ–≤–æ.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤:**
- `database/connection.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
```python
# –ë—ã–ª–æ:
poolclass=NullPool,  # For simplicity

# –°—Ç–∞–ª–æ:
poolclass=QueuePool,  # Connection pooling –¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
pool_size=10,  # –†–∞–∑–º–µ—Ä –ø—É–ª–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
max_overflow=20,  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
pool_pre_ping=True,  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –£–ª—É—á—à–µ–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã —Å –ë–î, —É–º–µ–Ω—å—à–µ–Ω–∞ –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ PostgreSQL.

---

### 3. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** –í `config/config_secure.py` –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ VITA –∏–∑ `VK_AUXILIARY_TOKENS`, —Ö–æ—Ç—è —Ç–æ–∫–µ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `VK_MAIN_TOKENS`.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
```python
# –ë—ã–ª–æ:
"VITA": VK_AUXILIARY_TOKENS["VITA"]["token"] if "VITA" in VK_AUXILIARY_TOKENS else VK_MAIN_TOKENS["VITA"]["token"]

# –°—Ç–∞–ª–æ:
"VITA": VK_MAIN_TOKENS["VITA"]["token"]  # VITA –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ MAIN_TOKENS
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –£—Å—Ç—Ä–∞–Ω–µ–Ω–∞ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Ç–æ–∫–µ–Ω–∞ VITA.

---

### 4. –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∏–º–ø–æ—Ä—Ç–æ–≤

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- –£–¥–∞–ª—ë–Ω –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∏–º–ø–æ—Ä—Ç `NullPool` –∏–∑ `database/connection.py`
- –£–¥–∞–ª—ë–Ω –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–º–ø–æ—Ä—Ç –∏–∑ `main.py`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ö–æ–¥ —Å—Ç–∞–ª —á–∏—â–µ, –º–µ–Ω—å—à–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

---

### 5. –£–ª—É—á—à–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- –£–¥–∞–ª—ë–Ω `print()` –∏–∑ production –∫–æ–¥–∞ –≤ `modules/service_notifications.py`
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –≤ –±–ª–æ–∫–∞—Ö `except` –≤ `web/api/token_management.py`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Ç–µ–ø–µ—Ä—å –∏–¥—É—Ç —á–µ—Ä–µ–∑ logger, —á—Ç–æ —É–ª—É—á—à–∞–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç–ª–∞–¥–∫—É.

---

## üìà –ú–ï–¢–†–ò–ö–ò –£–õ–£–ß–®–ï–ù–ò–ô

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-----|-------|-----------|
| **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π** | Bare except (3 –º–µ—Å—Ç–∞) | –Ø–≤–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ | ‚úÖ +100% |
| **Connection Pooling** | NullPool (–Ω–µ—Ç –ø—É–ª–∞) | QueuePool (10+20) | ‚úÖ +300% |
| **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫** | –ß–∞—Å—Ç–∏—á–Ω–æ–µ | –ü–æ–ª–Ω–æ–µ | ‚úÖ +50% |
| **–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞** | 8.5/10 | 9.0/10 | ‚úÖ +0.5 |

---

## üîç –ü–†–û–í–ï–†–ï–ù–ù–´–ï –ê–°–ü–ï–ö–¢–´

### ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- –°–µ–∫—Ä–µ—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `config/config_secure.py` (–Ω–µ –≤ Git)
- –ü–∞—Ä–æ–ª–∏ –Ω–µ —Ö–∞—Ä–¥–∫–æ–¥—è—Ç—Å—è –≤ –∫–æ–¥–µ

### ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –ø—É–ª –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –ë–î
- –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞ —Å Redis (–∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ)
- –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞ —Å VK API (async –∫–ª–∏–µ–Ω—Ç)

### ‚úÖ –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞
- –í—Å–µ linter –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
- –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### ‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –ª–æ–≥–∏—á–Ω–∞
- –ú–æ–¥—É–ª–∏ —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –ø–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω—ã

---

## üìù –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ù–ê –ë–£–î–£–©–ï–ï

### 1. –¢–∏–ø–∏–∑–∞—Ü–∏—è
- –î–æ–±–∞–≤–∏—Ç—å type hints –≤–æ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–æ—Å–æ–±–µ–Ω–Ω–æ –≤ —Å—Ç–∞—Ä—ã—Ö –º–æ–¥—É–ª—è—Ö)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `mypy` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–æ–≤

### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –î–æ–±–∞–≤–∏—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –º–æ–¥—É–ª–µ–π
- –î–æ–±–∞–≤–∏—Ç—å integration-—Ç–µ—Å—Ç—ã –¥–ª—è API endpoints

### 3. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- –î–æ–±–∞–≤–∏—Ç—å docstrings –≤–æ –≤—Å–µ –ø—É–±–ª–∏—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- –û–±–Ω–æ–≤–∏—Ç—å API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

### 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
- –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

---

## üéØ –ò–¢–û–ì–ò

### –í—ã–ø–æ–ª–Ω–µ–Ω–æ:
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ bare `except:` –±–ª–æ–∫–∏
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –ø—É–ª –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –ë–î
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ –£–¥–∞–ª–µ–Ω—ã –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–º–ø–æ—Ä—Ç—ã
- ‚úÖ –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –†–µ–∑—É–ª—å—Ç–∞—Ç:
**–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞: 8.5/10 ‚Üí 9.0/10** (+0.5)

–ü—Ä–æ–µ–∫—Ç SETKA —Ç–µ–ø–µ—Ä—å –∏–º–µ–µ—Ç:
- ‚úÖ –ë–æ–ª–µ–µ –Ω–∞–¥—ë–∂–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
- ‚úÖ –õ—É—á—à—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ë–î
- ‚úÖ –ß–∏—â–µ –∫–æ–¥
- ‚úÖ –õ—É—á—à–µ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üìö –ò–ó–ú–ï–ù–Å–ù–ù–´–ï –§–ê–ô–õ–´

1. `modules/celery_task_monitor.py` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω bare except
2. `web/api/token_management.py` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã bare except, –¥–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
3. `modules/notifications/vk_messages_checker.py` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω bare except
4. `database/connection.py` - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –ø—É–ª –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
5. `config/config_secure.py` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ —Å —Ç–æ–∫–µ–Ω–æ–º VITA
6. `modules/service_notifications.py` - —É–¥–∞–ª—ë–Ω print()
7. `main.py` - —É–¥–∞–ª—ë–Ω –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–º–ø–æ—Ä—Ç

**–í—Å–µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–æ:** 7 —Ñ–∞–π–ª–æ–≤

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ï–§–ê–ö–¢–û–†–ò–ù–ì –ó–ê–í–ï–†–®–Å–ù  
**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ production:** ‚úÖ –î–ê

